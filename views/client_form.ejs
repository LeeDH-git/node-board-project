<link rel="stylesheet" href="/css/style.css">

<main id="client-show" class="client-form">
  <div class="page-head">
    <div class="page-title-wrap">
      <div class="page-title">
        <%= pageTitle || (mode==='edit' ? '거래처 수정' : '거래처 등록' ) %>
      </div>
      <div class="sub">
        거래처 기본정보를 입력하세요.
      </div>
    </div>

    <div class="head-actions">
      <a href="/client" class="btn">목록</a>

      <button type="submit" form="client-form" class="btn btn-primary">
        <%= mode==='edit' ? '수정 저장' : '저장' %>
      </button>
    </div>
  </div>

  <form id="client-form" method="POST" action="<%= mode === 'edit' ? ('/client/' + client.id + '/edit') : '/client' %>"
    enctype="multipart/form-data">
    <!-- ✅ 카드 1: 기본정보 (UI는 상세보기와 동일한 card/meta-grid/kv) -->
    <div class="card">
      <div class="title" style="font-weight:800;">
        <%= (mode==='edit' ? (client.name || '-' ) : '거래처 정보' ) %>
      </div>

      <div class="meta-grid">
        <div>
          <div class="kv">
            <div class="k">거래처명 <span class="req">*</span></div>
            <div class="v">
              <input class="kv-input" name="name" required value="<%= client.name || '' %>" />
            </div>
          </div>

          <div class="kv">
            <div class="k">사업자번호</div>
            <div class="v">
              <input class="kv-input" name="biz_no" value="<%= client.biz_no || '' %>" />
            </div>
          </div>

          <div class="kv">
            <div class="k">대표자</div>
            <div class="v">
              <input class="kv-input" name="ceo_name" value="<%= client.ceo_name || '' %>" />
            </div>
          </div>

          <div class="kv">
            <div class="k">전화</div>
            <div class="v">
              <input class="kv-input" name="phone" value="<%= client.phone || '' %>" />
            </div>
          </div>
        </div>

        <div>
          <div class="kv">
            <div class="k">이메일</div>
            <div class="v">
              <input class="kv-input" type="email" name="email" value="<%= client.email || '' %>" />
            </div>
          </div>

          <div class="kv">
            <div class="k">주소</div>
            <div class="v">
              <input class="kv-input" name="address" value="<%= client.address || '' %>" />
            </div>
          </div>

          <div class="kv">
            <div class="k">등록일</div>
            <div class="v">
              <%= client.created_at ? String(client.created_at).substring(0,19) : "-" %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ✅ 카드 2: 메모 -->
    <div class="card">
      <div class="title" style="font-size:13px; margin-bottom:8px;">메모</div>

      <div class="meta-grid">
        <div style="grid-column: 1 / -1;">
          <div class="kv memo">
            <div class="k">내용</div>
            <div class="v">
              <textarea class="kv-textarea" name="memo" rows="6"><%= client.memo || '' %></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ✅ 카드 3: 사업자등록증 (첨부/표시) -->
    <div class="card">
      <div class="title" style="font-size:13px; margin-bottom:8px;">사업자등록증</div>

      <div class="meta-grid">
        <div style="grid-column: 1 / -1;">
          <div class="kv">
            <div class="k">파일</div>
            <div class="v">
              <% if (client.biz_cert_path) { %>
                <div class="file-row">
                  <a class="link" href="<%= client.biz_cert_path %>" target="_blank" rel="noreferrer">
                    <%= client.biz_cert_name || '첨부파일 보기' %>
                  </a>
                  <span class="muted" style="margin-left:8px;">(새 파일을 선택하면 교체됩니다)</span>
                </div>
                <% } else { %>
                  <div class="muted">첨부된 파일이 없습니다.</div>
                  <% } %>

                    <input class="kv-file" type="file" name="biz_cert" accept=".pdf,.png,.jpg,.jpeg" />
                    <div class="help">PDF/이미지(PNG/JPG)만 권장, 10MB 이하</div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </form>
</main>